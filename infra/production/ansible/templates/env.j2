# ============================================================================
# Environment Variables Template
# This file is generated by Ansible - do not edit manually
# ============================================================================

# ============================================================================
# Infrastructure Configuration
# ============================================================================

# MySQL Configuration
SPRING_DATASOURCE_URL=jdbc:mysql://{{ infra_endpoints.mysql_host }}:{{ infra_endpoints.mysql_port }}
SPRING_DATASOURCE_USERNAME={{ db_credentials.mysql.username }}
SPRING_DATASOURCE_PASSWORD={{ db_credentials.mysql.password }}
SPRING_DATASOURCE_DRIVER_CLASS_NAME=com.mysql.cj.jdbc.Driver
SPRING_JPA_HIBERNATE_DDL_AUTO=validate
SPRING_JPA_SHOW_SQL=false
SPRING_JPA_PROPERTIES_HIBERNATE_DIALECT=org.hibernate.dialect.MySQL8Dialect
SPRING_JPA_PROPERTIES_HIBERNATE_FORMAT_SQL=true

# MongoDB Configuration (DocumentDB)
SPRING_DATA_MONGODB_HOST={{ infra_endpoints.docdb_host }}
SPRING_DATA_MONGODB_PORT={{ infra_endpoints.docdb_port }}
SPRING_DATA_MONGODB_USERNAME={{ db_credentials.docdb.username }}
SPRING_DATA_MONGODB_PASSWORD={{ db_credentials.docdb.password }}
SPRING_DATA_MONGODB_AUTHENTICATION_DATABASE=admin
SPRING_DATA_MONGODB_SSL_ENABLED=true

# Redis Configuration (ElastiCache)
SPRING_DATA_REDIS_HOST={{ infra_endpoints.redis_host }}
SPRING_DATA_REDIS_PORT={{ infra_endpoints.redis_port }}
SPRING_DATA_REDIS_SSL=true
SPRING_DATA_REDIS_TIMEOUT=60000
SPRING_DATA_REDIS_JEDIS_POOL_MAX_ACTIVE=20
SPRING_DATA_REDIS_JEDIS_POOL_MAX_IDLE=10
SPRING_DATA_REDIS_JEDIS_POOL_MIN_IDLE=5

# Kafka Configuration (MSK)
SPRING_KAFKA_BOOTSTRAP_SERVERS={{ infra_endpoints.kafka_brokers }}
SPRING_KAFKA_SECURITY_PROTOCOL=SSL
SPRING_KAFKA_PRODUCER_KEY_SERIALIZER=org.apache.kafka.common.serialization.StringSerializer
SPRING_KAFKA_PRODUCER_VALUE_SERIALIZER=org.springframework.kafka.support.serializer.JsonSerializer
SPRING_KAFKA_CONSUMER_KEY_DESERIALIZER=org.apache.kafka.common.serialization.StringDeserializer
SPRING_KAFKA_CONSUMER_VALUE_DESERIALIZER=org.springframework.kafka.support.serializer.JsonDeserializer
SPRING_KAFKA_CONSUMER_GROUP_ID={{ project_name }}
SPRING_KAFKA_CONSUMER_AUTO_OFFSET_RESET=earliest
SPRING_KAFKA_CONSUMER_ENABLE_AUTO_COMMIT=false

# Elasticsearch Configuration (OpenSearch)
SPRING_ELASTICSEARCH_URIS=https://{{ infra_endpoints.opensearch_host }}:443
SPRING_ELASTICSEARCH_USERNAME={{ db_credentials.opensearch.username }}
SPRING_ELASTICSEARCH_PASSWORD={{ db_credentials.opensearch.password }}

# ============================================================================
# Service-Specific Configuration
# ============================================================================

# User Service (Port 8081)
USER_SERVICE_DB_NAME=user_db
USER_SERVICE_JWT_SECRET={{ jwt_secret_access | default('CHANGE_ME_ACCESS_TOKEN_SECRET') }}
USER_SERVICE_JWT_REFRESH_SECRET={{ jwt_secret_refresh | default('CHANGE_ME_REFRESH_TOKEN_SECRET') }}
USER_SERVICE_JWT_EXPIRATION=3600000
USER_SERVICE_JWT_REFRESH_EXPIRATION=86400000

# Product Service (Port 8082)
PRODUCT_SERVICE_DB_NAME=product_db
PRODUCT_SERVICE_SEARCH_INDEX=products

# Transaction Service (Port 8083)
TRANSACTION_SERVICE_DB_NAME=transaction_db

# Wallet Service (Port 8084)
WALLET_SERVICE_DB_NAME=wallet_db

# Notify Service (Port 8085)
NOTIFY_SERVICE_SMTP_HOST={{ smtp_host | default('localhost') }}
NOTIFY_SERVICE_SMTP_PORT={{ smtp_port | default('25') }}
NOTIFY_SERVICE_SMTP_USERNAME={{ smtp_username | default('') }}
NOTIFY_SERVICE_SMTP_PASSWORD={{ smtp_password | default('') }}

# Chat Core Service (Port 8091)
CHAT_CORE_DB_NAME=slack_clone
CHAT_CORE_GRPC_PORT=9091

# Chat Fanout Worker (Port 8092)
CHAT_FANOUT_GRPC_CLIENT_ADDRESS=localhost:9091

# Chat Socket Gateway (Port 8093)
CHAT_SOCKET_GRPC_CLIENT_ADDRESS=localhost:9091
CHAT_SOCKET_WEBSOCKET_ALLOWED_ORIGINS=*

# ============================================================================
# File Upload Configuration
# ============================================================================

FILE_UPLOAD_DIR=/opt/microservices/uploads
FILE_UPLOAD_MAX_SIZE=10485760
FILE_UPLOAD_ALLOWED_EXTENSIONS=jpg,jpeg,png,gif,pdf,doc,docx

# AWS S3 Configuration
AWS_S3_BUCKET={{ infra_endpoints.s3_bucket }}
AWS_REGION={{ aws_region }}
AWS_S3_ENABLED=true

# ============================================================================
# Application Configuration
# ============================================================================

SERVER_PORT=${SERVICE_PORT}
SPRING_PROFILES_ACTIVE=production
SPRING_APPLICATION_NAME=${SERVICE_NAME}

# Logging
LOGGING_LEVEL_ROOT={{ log_level }}
LOGGING_LEVEL_COM_MICROSERVICES=DEBUG
LOGGING_FILE_NAME={{ log_dir }}/${SERVICE_NAME}.log
LOGGING_FILE_MAX_SIZE=100MB
LOGGING_FILE_MAX_HISTORY=30
LOGGING_PATTERN_CONSOLE=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
LOGGING_PATTERN_FILE=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# Actuator (Health Check Endpoints)
MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE=health,info,metrics,prometheus
MANAGEMENT_ENDPOINT_HEALTH_SHOW_DETAILS=when_authorized
MANAGEMENT_HEALTH_DISKSPACE_ENABLED=true
MANAGEMENT_METRICS_EXPORT_PROMETHEUS_ENABLED=true

# ============================================================================
# Performance Tuning
# ============================================================================

# Tomcat Connection Pool
SERVER_TOMCAT_MAX_THREADS=200
SERVER_TOMCAT_MIN_SPARE_THREADS=10
SERVER_TOMCAT_MAX_CONNECTIONS=10000
SERVER_TOMCAT_ACCEPT_COUNT=100
SERVER_TOMCAT_CONNECTION_TIMEOUT=20000

# HikariCP (Database Connection Pool)
SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE=20
SPRING_DATASOURCE_HIKARI_MINIMUM_IDLE=5
SPRING_DATASOURCE_HIKARI_CONNECTION_TIMEOUT=30000
SPRING_DATASOURCE_HIKARI_IDLE_TIMEOUT=600000
SPRING_DATASOURCE_HIKARI_MAX_LIFETIME=1800000
